/**
 * almond 0.2.7 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(t,e){var i=!("function"!=typeof define||!define.amd),r="object"==typeof exports,n=r?require:function(t){throw new Error("uRequire detected missing dependency: '"+t+"' - in a non-nodejs runtime. All it's binding variables were 'undefined'.")},o={}.hasOwnProperty,s=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a=function(t,e){return function(){return t.apply(e,arguments)}},u=function(t,i){var o,u,h;return function(t){function e(t,e){return w.call(t,e)}function i(t,e){var i,r,n,o,s,a,u,h,p,c,l=e&&e.split("/"),f=x.map,d=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(l=l.slice(0,l.length-1),t=l.concat(t.split("/")),h=0;h<t.length;h+=1)if(c=t[h],"."===c)t.splice(h,1),h-=1;else if(".."===c){if(1===h&&(".."===t[2]||".."===t[0]))break;h>0&&(t.splice(h-1,2),h-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((l||d)&&f){for(i=t.split("/"),h=i.length;h>0;h-=1){if(r=i.slice(0,h).join("/"),l)for(p=l.length;p>0;p-=1)if(n=f[l.slice(0,p).join("/")],n&&(n=n[r])){o=n,s=h;break}if(o)break;!a&&d&&d[r]&&(a=d[r],u=h)}!o&&a&&(o=a,s=u),o&&(i.splice(0,s,o),t=i.join("/"))}return t}function r(e,i){return function(){return f.apply(t,S.call(arguments,0).concat([e,i]))}}function n(t){return function(e){return i(e,t)}}function s(t){return function(e){m[t]=e}}function a(i){if(e(y,i)){var r=y[i];delete y[i],v[i]=!0,l.apply(t,r)}if(!e(m,i)&&!e(v,i))throw new Error("No "+i);return m[i]}function p(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function c(t){return function(){return x&&x.config&&x.config[t]||{}}}var l,f,d,g,m={},y={},x={},v={},w=Object.prototype.hasOwnProperty,S=[].slice;d=function(t,e){var r,o=p(t),s=o[0];return t=o[1],s&&(s=i(s,e),r=a(s)),s?t=r&&r.normalize?r.normalize(t,n(e)):i(t,e):(t=i(t,e),o=p(t),s=o[0],t=o[1],s&&(r=a(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:r}},g={require:function(t){return r(t)},exports:function(t){var e=m[t];return"undefined"!=typeof e?e:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:c(t)}}},l=function(i,n,o,u){var h,p,c,l,f,x,w=[],S=typeof o;if(u=u||i,"undefined"===S||"function"===S){for(n=!n.length&&o.length?["require","exports","module"]:n,f=0;f<n.length;f+=1)if(l=d(n[f],u),p=l.f,"require"===p)w[f]=g.require(i);else if("exports"===p)w[f]=g.exports(i),x=!0;else if("module"===p)h=w[f]=g.module(i);else if(e(m,p)||e(y,p)||e(v,p))w[f]=a(p);else{if(!l.p)throw new Error(i+" missing "+p);l.p.load(l.n,r(u,!0),s(p),{}),w[f]=m[p]}c=o?o.apply(m[i],w):void 0,i&&(h&&h.exports!==t&&h.exports!==m[i]?m[i]=h.exports:c===t&&x||(m[i]=c))}else i&&(m[i]=o)},o=u=f=function(e,i,r,n,o){return"string"==typeof e?g[e]?g[e](i):a(d(e,i).f):(e.splice||(x=e,i.splice?(e=i,i=r,r=null):e=t),i=i||function(){},"function"==typeof r&&(r=n,n=o),n?l(t,e,i,r):setTimeout(function(){l(t,e,i,r)},4),f)},f.config=function(t){return x=t,x.deps&&f(x.deps,x.callback),f},o._defined=m,h=function(t,i,r){i.splice||(r=i,i=[]),e(m,t)||e(y,t)||(y[t]=[t,i,r])},h.amd={jQuery:!0}}(),h("almond",function(){}),h("events",[],function(){if(r)return n("events");throw new Error("uRequire: trying to access unbound / excluded 'node-only' dependency 'events') on browser")}),h("game",["require","exports","module"],function(t,e,i,e,i){var r;return r=function(){function t(t,e){this.wrapper=t,this.debug=null!=e?e:!1,this.tick=a(this.tick,this),this.canvas=this.wrapper.find("canvas").get(0),this.setSize(this.wrapper.width(),this.wrapper.height()),this.context=this.canvas.getContext("2d"),this.running=!1,this.debug&&this.setupStats()}return t.prototype.clearScreen=function(){return this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.setSize=function(t,e){return this.canvas.width=t,this.canvas.height=e},t.prototype.getWidth=function(){return this.canvas.width},t.prototype.getHeight=function(){return this.canvas.height},t.prototype.getWrapper=function(){return this.wrapper},t.prototype.setupStats=function(){var t;return this.fpsStats=new Stats,this.fpsStats.setMode(0),t=$(this.fpsStats.domElement),t.css({position:"absolute",left:-t.width(),top:0}),this.wrapper.append(this.fpsStats.domElement),this.fpsMsStats=new Stats,this.fpsMsStats.setMode(1),t=$(this.fpsMsStats.domElement),t.css({position:"absolute",left:-t.width(),top:50}),this.wrapper.append(this.fpsMsStats.domElement),this.tickStats=new Stats,this.tickStats.setMode(1),t=$(this.tickStats.domElement),t.css({position:"absolute",left:-t.width(),top:100}),this.wrapper.append(this.tickStats.domElement)},t.prototype.run=function(){return this.running=!0,this.lastTick=new Date,requestAnimFrame(this.tick)},t.prototype.stop=function(){return this.running=!1},t.prototype.tick=function(){var t,e,i;return t=(Date.now()-this.lastTick)/1e3,this.lastTick=Date.now(),this.debug&&this.tickStats.begin(),null!=(e=this.screen)&&e.update(t),this.debug&&this.tickStats.end(),this.debug&&this.fpsStats.begin(),this.debug&&this.fpsMsStats.begin(),this.clearScreen(),null!=(i=this.screen)&&i.draw(this.context),this.debug&&this.fpsStats.end(),this.debug&&this.fpsMsStats.end(),this.running?requestAnimFrame(this.tick):void 0},t}(),i.exports=r}),h("screen",["require","exports","module"],function(t,e,i,e,i){var r;return r=function(){function t(t){this.game=t}return t.prototype.update=function(){},t.prototype.draw=function(){},t}(),i.exports=r}),h("math/vector2",["require","exports","module"],function(t,e,i,e,i){var r;return r=function(){function t(t,e){this.x=null!=t?t:0,this.y=null!=e?e:0}return t.prototype.set=function(e,i){var r;return e instanceof t?(r=e,this.x=r.x,this.y=r.y):(this.x=e,this.y=i),this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.prototype.substract=function(e,i){var r;return e instanceof t?(r=e,e=r.getX(),i=r.getY()):null!=e&&null==i&&(i=e),this.x=this.x-e,this.y=this.y-i,this},t.prototype.add=function(e,i){var r;return e instanceof t?(r=e,e=r.getX(),i=r.getY()):null!=e&&null==i&&(i=e),this.x=this.x+e,this.y=this.y+i,this},t.prototype.divideBy=function(e,i){var r;return e instanceof t?(r=e,e=r.getX(),i=r.getY()):null!=e&&null==i&&(i=e),this.x=this.x/e,this.y=this.y/i,this},t.prototype.multiply=function(e,i){var r;return e instanceof t?(r=e,e=r.getX(),i=r.getY()):null!=e&&null==i&&(i=e),this.x=this.x*e,this.y=this.y*i,this},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.setX=function(t){return this.x=t},t.prototype.setY=function(t){return this.y=t},t}(),i.exports=r}),h("math/rectangle",["require","exports","module","./vector2"],function(t,e,i,e,i){var r,n;return n=t("./vector2"),r=function(){function t(t,e,i,r){null==t&&(t=0),null==e&&(e=0),this.width=null!=i?i:0,this.height=null!=r?r:0,this.position=new n(t,e)}return t.prototype.setPosition=function(){return this.position.set.call(this,arguments)},t.prototype.setSize=function(t,e){return this.width=t,this.height=e},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t}(),i.exports=r}),h("node",["require","exports","module","./math/vector2","./math/rectangle"],function(t,e,i,e,i){var r,n,o;return o=t("./math/vector2"),n=t("./math/rectangle"),r=function(){function t(t){this.game=t,this.origin=new o,this.position=new o,this.scale=new o(1,1),this.rect=new n}return t.prototype.getPosition=function(){return this.position},t.prototype.setPosition=function(t,e){return this.position.set(t,e)},t.prototype.getX=function(){return this.position.getX()},t.prototype.setX=function(t){return this.position.setX(t)},t.prototype.getY=function(){return this.position.getY()},t.prototype.setY=function(t){return this.position.setY(t)},t.prototype.getScale=function(){return this.scale},t.prototype.setScale=function(t,e){return this.scale.set(t,e)},t.prototype.getScaleX=function(){return this.scale.getX()},t.prototype.setScaleX=function(t){return this.scale.setX(t)},t.prototype.getScaleY=function(){return this.scale.getY()},t.prototype.setScaleY=function(t){return this.scale.setY(t)},t.prototype.getOrigin=function(){return this.origin},t.prototype.setOrigin=function(t,e){return this.origin.set(t,e)},t.prototype.getOriginX=function(){return this.scale.getX()},t.prototype.setOriginX=function(t){return this.origin.setX(t)},t.prototype.getOriginY=function(){return this.origin.getY()},t.prototype.setOriginY=function(t){return this.origin.setY(t)},t.prototype.getSize=function(){return this.rect.getSize()},t.prototype.setSize=function(t,e){return this.rect.setSize(t,e)},t.prototype.getWidth=function(){return this.rect.getWidth()},t.prototype.getHeight=function(){return this.rect.getHeight()},t}(),i.exports=r}),h("actor",["require","exports","module","./node"],function(t,e,i,e,i){var r,n;return n=t("./node"),r=function(t){function e(t){this.game=t,e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.update=function(){},e.prototype.draw=function(){},e}(n),i.exports=r}),h("stage",["require","exports","module"],function(t,e,i,e,i){var r;return r=function(){function t(t){this.game=t,this.actors=[]}return t.prototype.addActor=function(t){return this.actors.push(t)},t.prototype.removeActor=function(t){var e;return e=this.actors.indexOf(t),e>=0?this.actors.splice(e,1):void 0},t.prototype.update=function(t){var e,i,r,n,o;for(n=this.actors,o=[],i=0,r=n.length;r>i;i++)e=n[i],o.push(e.update(t));return o},t.prototype.draw=function(t){var e,i,r,n,o;for(n=this.actors,o=[],i=0,r=n.length;r>i;i++)e=n[i],o.push(e.draw(t));return o},t}(),i.exports=r}),h("graphics/sprite",["require","exports","module","../math/vector2","../node"],function(t,e,i,e,i){var r,n,o;return o=t("../math/vector2"),r=t("../node"),n=function(t){function e(t,i){this.textureAtlas=t,this.frame=i,e.__super__.constructor.apply(this,arguments),this.rotation=0}return s(e,t),e.renderOffset=new o(0,0),e.prototype.getWidth=function(){return this.frame.frame.w*this.scale.x},e.prototype.getHeight=function(){return this.frame.frame.h*this.scale.y},e.prototype.getRotation=function(){return this.rotation},e.prototype.setRotation=function(t){return this.rotation=t},e.prototype.draw=function(t,i,r,n){var o,s,a,u,h,p,c,l,f;return null==n&&(n=!1),a=this.textureAtlas.getAtlasImage(),p=this.frame.frame.x,c=this.frame.frame.y,h=this.frame.frame.w,u=this.frame.frame.h,s=this.frame.frame.w*this.scale.x,o=this.frame.frame.h*this.scale.y,t.save(),l=Math.round((i||this.position.x)+this.origin.x+e.renderOffset.x),f=Math.round((r||this.position.y)+this.origin.y+e.renderOffset.y),n?(t.translate(l+s,f),t.scale(-1,1)):t.translate(l,f),t.rotate(Math.PI/180*this.rotation),t.drawImage(a,p,c,h,u,-this.origin.x,-this.origin.y,s,o),t.restore()},e}(r),i.exports=n}),h("graphics/animsprite",["require","exports","module","../math/vector2","./sprite"],function(t,e,i,e,i){var r,n,o;return o=t("../math/vector2"),n=t("./sprite"),r=function(t){function e(t,i,r,n){this.textureAtlas=t,this.frame=i,this.spriteCount=r,this.animationInterval=n,e.__super__.constructor.apply(this,arguments),this.rotation=0,this.sumDelta=0,this.spriteIndex=0}return s(e,t),e.prototype.getWidth=function(){return this.frame.frame.w*this.scale.x},e.prototype.getHeight=function(){return this.frame.frame.h*this.scale.y},e.prototype.getRotation=function(){return this.rotation},e.prototype.setRotation=function(t){return this.rotation=t},e.prototype.update=function(t){return this.sumDelta>=this.animationInterval&&(this.spriteIndex++,this.spriteIndex>this.spriteCount-1&&(this.spriteIndex=0),this.sumDelta-=this.animationInterval),this.sumDelta+=t},e.prototype.draw=function(t,e,i,r){var o,s,a,u,h,p,c,l,f,d;return null==r&&(r=!1),a=this.textureAtlas.getAtlasImage(),d=Math.floor(this.frame.frame.w/this.spriteCount),p=this.frame.frame.x,c=this.frame.frame.y,h=d,u=this.frame.frame.h,p+=d*this.spriteIndex,s=d*this.scale.x,o=this.frame.frame.h*this.scale.y,t.save(),l=(e|this.position.x)+this.origin.x+n.renderOffset.x,f=(i|this.position.y)+this.origin.y+n.renderOffset.y,r?(t.translate(l+s,f),t.scale(-1,1)):t.translate(l,f),t.rotate(Math.PI/180*this.rotation),t.drawImage(a,p,c,h,u,-this.origin.x,-this.origin.y,s,o),t.restore()},e}(n),i.exports=r}),h("graphics/textureregion",["require","exports","module","../math/vector2"],function(t,e,i,e,i){var r,n;return n=t("../math/vector2"),r=function(){function t(t,e){this.atlas=t,this.frame=e,this.image=this.atlas.getAtlasImage()}return t.prototype.draw=function(t,e,i,r,n,o,s){var a,u,h,p;return h=this.frame.frame.x+e,p=this.frame.frame.y+i,r=Math.min(r,this.frame.spriteSourceSize.w+this.frame.frame.x-(this.frame.frame.x+e)),n=Math.min(n,this.frame.spriteSourceSize.h+this.frame.frame.y-(this.frame.frame.y+i)),u=r,a=n,0!==r&&0!==n?t.drawImage(this.image,h,p,r,n,o,s,u,a):void 0},t}(),i.exports=r}),h("graphics/textureatlas",["require","exports","module","./sprite","./animsprite","./textureregion"],function(t,e,i,e,i){var r,n,o,s;return n=t("./sprite"),r=t("./animsprite"),s=t("./textureregion"),o=function(){function t(t,e){this.frames=t,this.image=e}return t.prototype.createSprite=function(t){var e;if(null==this.frames[t])throw new Error("The sprite "+t+" could not be found.");return e=new n(this,this.frames[t])},t.prototype.createAnimSprite=function(t,e,i){var n;if(null==this.frames[t])throw new Error("The sprite "+t+" could not be found.");return n=new r(this,this.frames[t],e,i)},t.prototype.findRegion=function(t){var e;if(null==this.frames[t])throw new Error("The region "+t+" could not be found.");return e=new s(this,this.frames[t])},t.prototype.getAtlasImage=function(){return this.image},t}(),i.exports=o}),h("graphics/bitmapfont",["require","exports","module","../math/rectangle"],function(t,e,i,e,i){var r,n;return n=t("../math/rectangle"),r=function(){function t(t,e){this.fontFile=t,this.textureRegion=e,this.chars={},this.parseFontFile()}return t.prototype.parseFontFile=function(){var t,e,i,r,n,o,s,a,u,h,p,c,l,f;for(p=this.fontFile.split("\n"),f=[],s=0,u=p.length;u>s;s++)if(i=p[s],n=i.split(" "),"char"===n[0]){for(t={},c=n.slice(1,-1),a=0,h=c.length;h>a;a++)r=c[a],l=r.split("="),e=l[0],o=l[1],t[e]=parseInt(o);f.push(this.chars[t.id]=t)}else f.push(void 0);return f},t.prototype.getBounds=function(t){var e,i,r,o,s,a,u,h;for(a=0,o=0,s=u=0,h=t.length;h>=0?h>u:u>h;s=h>=0?++u:--u)r=t.substr(s,1),i=r.charCodeAt(0),null!=this.chars[i]&&(e=this.chars[i],a+=e.xadvance,o=e.height);return new n(0,0,a,o)},t.prototype.drawText=function(t,e,i,r){var n,o,s,a,u,h,p,c;for(u=0,c=[],a=h=0,p=e.length;p>=0?p>h:h>p;a=p>=0?++h:--h)s=e.substr(a,1),o=s.charCodeAt(0),null!=this.chars[o]&&(n=this.chars[o],this.textureRegion.draw(t,n.x,n.y,n.width,n.height,i+u+n.xoffset||0,r+n.yoffset||0),c.push(u+=n.xadvance));return c},t}(),i.exports=r}),h("graphics/tilemap",["require","exports","module","../math/vector2","../node","../actor"],function(t,e,i,e,i){var r,n,o,s;return s=t("../math/vector2"),n=t("../node"),r=t("../actor"),o=function(){function t(t,e,i){var r,n,o,s,a;for(this.game=t,this.image=i,this.tileWidth=e.tileheight,this.tileHeight=e.tilewidth,this.tileSpacing=e.tilesets[0].spacing,this.layers=[],a=e.layers,o=0,s=a.length;s>o;o++)r=a[o],n=r.data,n.width=r.width,n.height=r.height,n.scrollX=0,n.scrollY=0,this.layers.push(n);this.numTilesOnTileSetX=(this.image.width-this.tileSpacing)/(this.tileWidth+this.tileSpacing)}return t.prototype.setScrollX=function(t){var e,i,r,n,o;for(n=this.layers,o=[],i=0,r=n.length;r>i;i++)e=n[i],o.push(e.scrollX=t);return o},t.prototype.setScrollY=function(t){var e,i,r,n,o;for(n=this.layers,o=[],i=0,r=n.length;r>i;i++)e=n[i],o.push(e.scrollY=t);return o},t.prototype.setScrollX=function(t,e){return this.layers[t].scrollX=e},t.prototype.setScrollY=function(t,e){return this.layers[t].scrollY=e},t.prototype.getScrollX=function(t){return this.layers[t].scrollX},t.prototype.getScrollY=function(t){return this.layers[t].scrollY},t.prototype.draw=function(t){var e,i,r,n,o,s,a,u,h,p,c,l,f,d,g,m,y,x,v,w,S;for(w=this.layers,S=[],x=0,v=w.length;v>x;x++)s=w[x],d=Math.ceil(this.game.getWidth()/this.tileWidth),g=Math.ceil(this.game.getHeight()/this.tileHeight),p=this.tileWidth,a=this.tileHeight,i=this.tileWidth,e=this.tileHeight,n=Math.floor(s.scrollX/this.tileWidth),o=Math.floor(s.scrollY/this.tileHeight),u=s.scrollX%this.tileWidth,h=s.scrollY%this.tileHeight,null!=this.image?S.push(function(){var x,v;for(v=[],y=x=0;g>=0?g>=x:x>=g;y=g>=0?++x:--x)v.push(function(){var g,x;for(x=[],m=g=0;d>=0?d>=g:g>=d;m=d>=0?++g:--g)r=m+n+(y+o)*s.width,f=s[r]-1,c=this.tileSpacing+(this.tileWidth+this.tileSpacing)*(f%this.numTilesOnTileSetX),l=this.tileSpacing+(this.tileHeight+this.tileSpacing)*Math.floor(f/this.numTilesOnTileSetX),x.push(t.drawImage(this.image,c,l,p,a,m*i-u,y*e-h,i,e));return x}.call(this));return v}.call(this)):S.push(void 0);return S},t}(),i.exports=o}),h("async",[],function(){return r?n("async"):"undefined"!=typeof t?t:"undefined"!=typeof i?i:n("async")}),h("utilities/preloader",["require","exports","module","async"],function(t,e,i,e,i){var r,n,o;return r=t("events").EventEmitter,o=t("async"),n=function(t){function e(t,e){this.app=t,this.itemFilenames=e,this.loadJPEG=a(this.loadJPEG,this),this.loadJPG=a(this.loadJPG,this),this.loadPNG=a(this.loadPNG,this),this.loadItem=a(this.loadItem,this),this.items={}}return s(e,t),e.prototype.load=function(){var t=this;return o.map(this.itemFilenames,this.loadItem,function(e,i){var r,n,o;for(n=0,o=i.length;o>n;n++)r=i[n],t.items[r.filename]=r.item;return t.emit("done")})},e.prototype.get=function(t){if(null==this.items[t])throw new Error("The file "+t+" has not been preloaded!");return this.items[t]},e.prototype.loadItem=function(t,e){var i,r;if(i=t.split(".").pop(),r=this["load"+i.toUpperCase()],null==r)throw new Error("No loading method for "+t);return r(t,e)},e.prototype.loadJSON=function(t,e){return $.getJSON(t,function(i){return e(null,{filename:t,item:i})})},e.prototype.loadFNT=function(t,e){return $.get(t,function(i){return e(null,{filename:t,item:i})})},e.prototype.loadImage=function(t,e){var i;return i=new Image,i.onload=function(){return e(null,{filename:t,item:i})},i.src=t},e.prototype.loadPNG=function(){return this.loadImage.apply(this,arguments)},e.prototype.loadJPG=function(){return this.loadImage.apply(this,arguments)},e.prototype.loadJPEG=function(){return this.loadImage.apply(this,arguments)},e}(r),i.exports=n}),h(["require","exports","module","./game","./screen","./actor","./stage","./node","./graphics/textureatlas","./graphics/textureregion","./graphics/sprite","./graphics/bitmapfont","./graphics/tilemap","./math/vector2","./utilities/preloader"],function(t,i,r){var n;return n={Game:t("./game"),Screen:t("./screen"),Actor:t("./actor"),Stage:t("./stage"),Node:t("./node"),TextureAtlas:t("./graphics/textureatlas"),TextureRegion:t("./graphics/textureregion"),Sprite:t("./graphics/sprite"),BitmapFont:t("./graphics/bitmapfont"),TileMap:t("./graphics/tilemap"),Vector2:t("./math/vector2"),Preloader:t("./utilities/preloader")},"undefined"!=typeof h&&null!==h?h(function(t,e,i){return i.exports=n}):null!=("undefined"!=typeof r&&null!==r?r.exports:void 0)?r.exports=n:e.LDFW=n,r.exports}),u("ldfw")};return i?define(["async","async"],u):r?module.exports=u(require("async"),require("async")):u("undefined"!=typeof exports?exports:"undefined"!=typeof async?async:void 0,"undefined"!=typeof exports?exports:"undefined"!=typeof async?async:void 0)}).call(this,"object"==typeof exports?global:window,"object"==typeof exports?global:window);